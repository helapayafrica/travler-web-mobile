<p-button
  (click)="filterVisible=true"
  icon="bi bi-sliders2"
  iconPos="left"
  label="{{ 'filterSort.buttonLabel' | translate }}"
  size="small"
  styleClass="custom-btn p-button-sm">
</p-button>

<p-drawer [(visible)]="filterVisible"
          [style]="{ height: 'auto', overflow: 'auto', maxHeight: '80vh', minHeight: '40vh'}"
          header="{{ 'filterSort.drawerHeader' | translate }}"
          position="bottom"
          size="small">

  <p-tabs value="0">
    <p-tablist class="scroll-tabs">
      <p-tab value="0">{{ 'filterSort.tabs.company' | translate }}</p-tab>
      <p-tab value="1">{{ 'filterSort.tabs.boardingPoint' | translate }}</p-tab>
      <p-tab value="2">{{ 'filterSort.tabs.droppingPoint' | translate }}</p-tab>
      <p-tab value="3">{{ 'filterSort.tabs.departureTime' | translate }}</p-tab>
      <p-tab value="4">{{ 'filterSort.tabs.amenities' | translate }}</p-tab>
    </p-tablist>

    <p-tabpanels>
      <!-- Companies -->
      <p-tabpanel value="0">
        <h5 class="fs-6 fw-bold mb-2 text-muted">{{ 'filterSort.labels.busCompanies' | translate }}</h5>
        <div class="mb-3">
          <input (input)="filterCompanies()"
                 [(ngModel)]="companySearchTerm"
                 class="form-control form-control-sm"
                 placeholder="{{ 'filterSort.placeholders.searchCompanies' | translate }}"
                 type="text">
        </div>
        <div class="d-flex flex-column gap-2">
          <label *ngFor="let bus of filteredBusNames;" class="block gap-2 fw-normal fst-normal">
            <input (change)="onCompanySelectionChange($event)"
                   [value]="bus.id"
                   class="me-2"
                   type="checkbox">
            {{ bus.name | capitalize }}
          </label>
        </div>
      </p-tabpanel>

      <!-- Boarding Points -->
      <p-tabpanel value="1">
        <h5 class="fs-6 fw-bold mb-2 text-muted">{{ 'filterSort.labels.boardingPoints' | translate }}</h5>
        <div class="mb-3">
          <input (input)="filterBoardingPoints()"
                 [(ngModel)]="boardingPointSearchTerm"
                 class="form-control form-control-sm"
                 placeholder="{{ 'filterSort.placeholders.searchBoardingPoints' | translate }}"
                 type="text">
        </div>
        <div class="d-flex flex-column gap-2">
          <label *ngFor="let point of filteredBoardingPoints;" class="block gap-2 fw-normal fs-6">
            <input (change)="onBoardingPointSelectionChange($event)"
                   [value]="point.id"
                   class="me-2"
                   type="checkbox">
            {{ point.name }}
          </label>
        </div>
      </p-tabpanel>

      <!-- Dropping Points -->
      <p-tabpanel value="2">
        <h5 class="fs-6 fw-bold mb-2 text-muted">{{ 'filterSort.labels.droppingPoints' | translate }}</h5>
        <div class="mb-3">
          <input (input)="filterDroppingPoints()"
                 [(ngModel)]="droppingPointSearchTerm"
                 class="form-control form-control-sm"
                 placeholder="{{ 'filterSort.placeholders.searchDroppingPoints' | translate }}"
                 type="text">
        </div>
        <div class="d-flex flex-column gap-2">
          <label *ngFor="let point of filteredDroppingPoints;"
                 [for]="point.id"
                 class="block gap-2 fw-normal fst-normal">
            <input (change)="onDroppingPointSelectionChange($event)"
                   [id]="point.id"
                   [value]="point.id"
                   class="me-2"
                   type="checkbox">
            {{ point.name }}
          </label>
        </div>
      </p-tabpanel>

      <!-- Departure Time -->
      <p-tabpanel value="3">
        <h5 class="fs-6 fw-bold mb-2 text-muted">{{ 'filterSort.labels.departureTime' | translate }}</h5>
        <div class="mb-3">
          <input (input)="filterDepartureTime()"
                 [(ngModel)]="departureTimeSearchTerm"
                 class="form-control form-control-sm"
                 placeholder="{{ 'filterSort.placeholders.searchTimeRanges' | translate }}"
                 type="text">
        </div>
        <div class="d-flex flex-column gap-2">
          <label *ngFor="let time of filteredTimeRanges"
                 [for]="time.id"
                 class="block gap-2 fw-normal fst-normal">
            <input (change)="onDepartureTimeSelectionChange($event)"
                   [id]="time.id"
                   [value]="time.name"
                   class="me-2"
                   type="checkbox">
            {{ time.name }}
          </label>
        </div>
      </p-tabpanel>

      <!-- Amenities -->
      <p-tabpanel value="4">
        <h5 class="fs-6 fw-bold mb-2 text-muted">{{ 'filterSort.labels.amenities' | translate }}</h5>
        <div class="mb-3">
          <input (input)="filterAmenities()"
                 [(ngModel)]="amenitiesSearchTerm"
                 class="form-control form-control-sm"
                 placeholder="{{ 'filterSort.placeholders.searchAmenities' | translate }}"
                 type="text">
        </div>
        <div class="d-flex flex-column gap-2">
          <label *ngFor="let point of filteredAmenities;"
                 [for]="point.id"
                 class="block gap-2 fw-normal fst-normal">
            <input (change)="onAmenitiesSelectionChange($event)"
                   [id]="point.id"
                   [value]="point.id"
                   class="me-2"
                   type="checkbox">
            {{ point.name }}
          </label>
        </div>
      </p-tabpanel>

    </p-tabpanels>
  </p-tabs>

  <!-- Footer buttons -->
  <div class="row p-3">
    <div class="col-6">
      <p-button (click)="clearAllFilters()"
                label="{{ 'filterSort.buttons.clear' | translate }}"
                size="large"
                styleClass="p-button-outlined p-button-secondary p-button-rounded w-100">
      </p-button>
    </div>
    <div class="col-6">
      <p-button (click)="filterVisible = false; applyFilter()"
                label="{{ 'filterSort.buttons.save' | translate }}"
                size="large"
                styleClass="p-button-rounded w-100">
      </p-button>
    </div>
  </div>
</p-drawer>
