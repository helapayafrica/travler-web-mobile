<div class="row bg-transparent">
  <div
    [@columnAnim]="isViewSeatOpen() ? 'hidden' : 'visible'"
    [ngClass]="isViewSeatOpen() ? 'd-none' :'col-12 col-lg-3 d-none d-lg-block'">
    <app-search-refine-filters></app-search-refine-filters>
  </div>

  <div
    [ngClass]="isViewSeatOpen() ? 'col-12 col-lg-7 d-lg-block': 'col-12 col-lg-9'">
    <div>
      <div class="row">
        <div class="col-12 ">
          <div class="d-flex justify-content-between gap-2 align-items-center mb-1">
            <p class="text-muted mb-0 fs-5">{{ data.length }} @if (data.length > 1) {
              Buses
            } @else {
              Bus
            } found</p>
            <p
              class="rounded-pill bg-primary-subtle text-primary-emphasis mb-0 fw-semibold">{{ travelDate | date: 'EEE, d MMM' }}</p>
          </div>

        </div>


        <div class="col-sm-3 col-4">


          <!--              &lt;!&ndash;-->
          <!--              <select class="form-select" [(ngModel)]="currency" (change)="onCurrency($event)">-->
          <!--                <option value="1">KES</option>-->
          <!--                <option value="2">UGX</option>-->

          <!--              </select> &ndash;&gt;-->
        </div>
      </div>


      <ul class="nav nav-tabs  ">
        <li class="nav-item">
          <a (click)="!isReturnSelected() && selectTab('onward')" [class.active]="selectedTab === 'onward'"
             [class.disabled]="selectedTab === 'return'"
             class="nav-link" href="javascript:void(0)">
            ONWARD JOURNEY
          </a>
        </li>
        <li *ngIf="type==='twoway'" class="nav-item">
          <a (click)="!isReturnDisabled && selectTab('return')" [class.active]="selectedTab === 'return'"
             [class.disabled]="isReturnDisabled"
             class="nav-link" href="javascript:void(0)">
            RETURN JOURNEY
          </a>
        </li>
        <!--            &lt;!&ndash; reschedule &ndash;&gt;-->
        <!--            <li class="nav-item" *ngIf="type==='reschedule'">-->
        <!--              <a class="nav-link" [class.active]="selectedTab === 'reschedule'" [class.disabled]="isReturnDisabled"-->
        <!--                href="javascript:void(0)" (click)="!isReturnDisabled && selectTab('reschedule')">-->
        <!--                RESCHEDULE-->
        <!--              </a>-->
        <!--            </li>-->
      </ul>

      <!-- Tab Content -->
      <div
        class="tab-content mt-2 overflow-y-auto my-scrollable  "
        style="max-height:75vh">
        <!-- Onward Journey -->
        <div [class.active]="selectedTab === 'onward'" [class.show]="selectedTab === 'onward'" class="tab-pane fade p-0"
             id="onward">

          <!-- <div class="row mb-3">
              <div class="col-sm-9 col-6"></div>
              <div class="col-sm-3 col-6">
                <mat-form-field appearance="outline" class="small-form-field w-100">
                  <mat-label>Currency</mat-label>
                  <mat-select  [(ngModel)]="currency" (selectionChange)="onCurrency($event)">
                    <mat-option value="1">KES</mat-option>
                    <mat-option value="2">UGX</mat-option>
                  </mat-select>
                </mat-form-field>
              </div>
            </div> -->

          <div class="vstack">
            <app-component-search-results-card (viewSeatOpen)="getCollapseSeatState($event)" [data]="data"
                                               [isLoading]="isLoading"
                                               [type]="type"></app-component-search-results-card>
          </div>
        </div>

        <!-- Return Journey -->
        <div *ngIf="type==='twoway'">
          <div *ngIf="selectedTab === 'return'" class="container tab-pane fade show active" id="return">

            <h6>{{ payload.destination_name }} → {{ payload.source_name }}</h6>
            <p>{{ payload.return_date | date: 'dd MMM yyyy' }}</p>

            <div class="vstack gap-3">
              <app-component-search-results-card (viewSeatOpen)="getCollapseSeatState($event)" [data]="return_buses"
                                                 [isLoading]="isLoading"
                                                 [type]="type"></app-component-search-results-card>
            </div>

          </div>
        </div>


        <!-- Reschedule -->
        <div *ngIf="type==='reschedule'">
          <div *ngIf="selectedTab === 'reschedule'" class="container tab-pane fade show active" id="reschedule">

            <h6>{{ payload.destination_name }} → {{ payload.source_name }}</h6>
            <p>{{ payload.return_date | date: 'dd MMM yyyy' }}</p>

            <div class="vstack gap-3">
              <app-component-search-results-card (viewSeatOpen)="getCollapseSeatState($event)" [data]="return_buses"
                                                 [isLoading]="isLoading"
                                                 [type]="type"></app-component-search-results-card>
            </div>

          </div>
        </div>
      </div>


      <!-- One-Way Journey (Hidden when "Return" tab is active) -->
      <!-- <div hidden="type==='onward' && selectedTab !== 'return'">
        <div class="vstack">
          <app-component-search-results-card [isLoading]="isLoading" (viewSeatOpen)="getCollapseSeatState($event)"  [data]="data"></app-component-search-results-card>
        </div>
      </div> -->
    </div>
  </div>


  <div
    [@columnAnim]="isViewSeatOpen() ? 'visible' : 'hidden'"
    [ngClass]="isViewSeatOpen() ? 'd-none col-md-5 col-lg-5  d-lg-block': 'd-none'">
    <div class="m-1">
      <div class="rounded">
        <div class="row g-3">
          <div class="col-12 ">
            <div class="">
              <app-component-bus-seat-selector [busData]="busdata" [payload]="seat_data"
                                               [type]="type"></app-component-bus-seat-selector>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>


