import{a as $,c as ee}from"./chunk-XBVJRCQK.js";import{b as X}from"./chunk-MRT37FHK.js";import{a as ie}from"./chunk-6VJONNZN.js";import{a as Z}from"./chunk-CBO7K72Y.js";import{a as te}from"./chunk-5MO6MPKA.js";import"./chunk-VBQ6VRJ5.js";import{c as J}from"./chunk-AY2LLG5T.js";import"./chunk-DNQPFKDS.js";import"./chunk-6THMQCJO.js";import"./chunk-BA5OYKA4.js";import{a as oe}from"./chunk-JPC3RVDF.js";import"./chunk-IOPHG2KH.js";import{c as H}from"./chunk-H4ZN6NX2.js";import"./chunk-D3BB2YUO.js";import"./chunk-ZRTNA5AZ.js";import"./chunk-ZGVWO2O4.js";import{g as q,h as D,l as Q}from"./chunk-NMHFSZUN.js";import"./chunk-4QCEHMDE.js";import{a as W}from"./chunk-LF2IBCJR.js";import"./chunk-KLFOQ2RT.js";import{B as K,c as V,d as v,f as A,g as O,j as L,l as j,m as G,p as U,q as Y,z}from"./chunk-RAZRMRQX.js";import"./chunk-7UZYWCAJ.js";import"./chunk-6LBJZWJB.js";import{k as T,v as N}from"./chunk-GPQBVM7U.js";import{c as R}from"./chunk-35RUP4P6.js";import{Ib as E,Ic as r,Jb as M,Jc as o,Ob as p,Pb as a,Qb as n,Rb as u,_a as e,bc as P,lb as y,qb as B,rc as l,sc as c,tc as f,wb as h,zc as b}from"./chunk-45NCVV7C.js";import{h as re}from"./chunk-TWZW5B45.js";var F=re(oe());function ae(i,s){i&1&&(a(0,"small",36),l(1),r(2,"translate"),n()),i&2&&(e(),f(" ",o(2,1,"signup.validation.nameRequired")," "))}function le(i,s){i&1&&(a(0,"small",36),l(1),r(2,"translate"),n()),i&2&&(e(),f(" ",o(2,1,"signup.validation.codeRequired")," "))}function pe(i,s){i&1&&(a(0,"small",36),l(1),r(2,"translate"),n()),i&2&&(e(),f(" ",o(2,1,"signup.validation.phoneRequired")," "))}function se(i,s){i&1&&(a(0,"div",7)(1,"div",8)(2,"label",37),l(3),r(4,"translate"),n(),u(5,"input",38),r(6,"translate"),n()()),i&2&&(e(3),c(o(4,3,"signup.labels.promoCode")),e(2),p("placeholder",b(o(6,5,"signup.placeholders.promoCode"))))}function de(i,s){i&1&&(a(0,"small",36),l(1),r(2,"translate"),n()),i&2&&(e(),f(" ",o(2,1,"signup.validation.passwordRequired")," "))}function me(i,s){i&1&&(a(0,"small",36),l(1),r(2,"translate"),n()),i&2&&(e(),f(" ",o(2,1,"signup.validation.passwordMinLength")," "))}function ue(i,s){i&1&&(a(0,"small",36),l(1),r(2,"translate"),n()),i&2&&(e(),f(" ",o(2,1,"signup.validation.confirmPasswordRequired")," "))}function ce(i,s){i&1&&(a(0,"small",36),l(1),r(2,"translate"),n()),i&2&&(e(),f(" ",o(2,1,"signup.validation.passwordsMustMatch")," "))}function ge(i,s){i&1&&(a(0,"small",36),l(1),r(2,"translate"),n()),i&2&&(e(),f(" ",o(2,1,"signup.validation.termsRequired")," "))}function fe(i,s){i&1&&u(0,"span",39)}var ne=class i{constructor(s,d,t,g,m){this.fb=s;this.router=d;this.modalService=t;this.service=g;this.bookingService=m}payload={phone:"742700488",country_code:"254",device_number:"20ow72udawc8ra2m8lge34",sourcetype:"web"};otpControl=new L("");loadingConfig={animationType:$.chasingDots,backdropBorderRadius:"10px",primaryColour:"red",secondaryColour:"black",fullScreenBackdrop:!0,tertiaryColour:"#ffffff"};today=new Date;maxDOB=new Date(this.today.getFullYear()-13,this.today.getMonth(),this.today.getDate());otpConfig={length:6,inputClass:"otp-input"};loading=!1;signupForm;isSubmitting=!1;showPassword=!1;country_codes=[{code:"254",country:"Kenya"},{code:"255",country:"Tanzania"},{code:"256",country:"Uganda"},{code:"250",country:"Rwanda"}];codes=[{value:"254",label:"+254"},{value:"255",label:"+255"},{value:"256",label:"+256"},{value:"250",label:"+250"}];ngOnInit(){this.initForm()}initForm(){this.signupForm=this.fb.group({name:["",[v.required]],more:[!1,[v.required]],coupon_code:[""],phone_number:["",[v.required]],country_code:["",[v.required]],password:["",[v.required,v.minLength(5)]],confirmPassword:["",[v.required]],terms:[!1,[v.requiredTrue]]},{validators:this.mustMatch("password","confirmPassword")})}mustMatch(s,d){return t=>{let g=t.get(s),m=t.get(d);return!g||!m||m.errors&&!m.errors.mustMatch?null:g.value!==m.value?(m.setErrors({mustMatch:!0}),{mustMatch:!0}):(m.setErrors(null),null)}}togglePasswordVisibility(){this.showPassword=!this.showPassword}onSubmit(){if(this.signupForm.invalid){Object.keys(this.signupForm.controls).forEach(d=>{this.signupForm.get(d)?.markAsTouched()});return}let s=this.signupForm.value;console.log("[Form Data]",s),this.loading=!0,this.isSubmitting=!0,this.payload.device_number=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),this.payload.phone=s.phone_number,console.log(this.payload),this.service.sendOtp(this.payload).subscribe({next:d=>{if(this.loading=!1,this.isSubmitting=!1,d.isSuccess){this.modalService.openModal("verificationModal"),console.log("[Send Otp Response]"),console.log(d);let t={name:this.signupForm.value.name,phone:this.payload.phone,password:this.signupForm.value.password,country_code:this.payload.country_code,device_number:this.payload.device_number,coupon_code:this.payload.coupon_code,verification_key:Number(d.verification_key),currency_code:"",gcm_token:"",sourcetype:"web"};console.log("[Registering User data being saved in local storage]"),console.log(t),this.bookingService.setConfig("registeringUser",t)}else F.default.fire({icon:"error",title:"Request Failed",text:d.message,width:"350px",showCancelButton:!0,customClass:{popup:"tiny-swal",icon:"tiny-icon"}})},error:d=>{this.loading=!1,this.isSubmitting=!1,F.default.fire({icon:"error",title:"Error",text:"Something went wrong. Please try again.",width:"350px",customClass:{popup:"tiny-swal",icon:"tiny-icon"}})}})}static \u0275fac=function(d){return new(d||i)(y(z),y(q),y(X),y(W),y(Q))};static \u0275cmp=B({type:i,selectors:[["app-view-auth-signup"]],decls:77,vars:71,consts:[[1,"container"],[1,"card","shadow","p-4","my-3"],[1,"text-center"],["alt","logo","height","auto","src","assets/WEBP/logo.webp","width","180px"],[1,"text-center","mb-4"],[3,"ngSubmit","formGroup"],[1,"row"],[1,"mt-2","col-12"],[1,"d-flex","flex-column","gap-1"],["for","name",1,"fw-medium"],["formControlName","name","id","name","pInputText","","type","text",1,"w-100",3,"placeholder"],["class","text-danger",4,"ngIf"],[1,"mt-2","col-4"],["for","code",1,"fw-medium"],["formControlName","country_code","id","code","optionLabel","label",1,"w-100",3,"options","placeholder"],[1,"mt-2","col-8"],["for","phone",1,"fw-medium"],["formControlName","phone_number","id","phone","pInputText","","type","number",1,"w-100",3,"placeholder"],[1,"my-3","col-12"],[1,"d-flex","align-items-center","gap-2"],["formControlName","more","inputId","coupon_code",3,"binary"],["for","coupon_code",1,"small"],[1,"mt-2","col-6"],["for","password",1,"fw-medium"],["formControlName","password","inputStyleClass","w-100",3,"feedback","toggleMask","placeholder"],["for","confPassword",1,"fw-medium"],["formControlName","confirmPassword","inputStyleClass","w-100",3,"feedback","toggleMask","placeholder"],[1,"mt-3","col-12"],["formControlName","terms","inputId","terms",3,"binary"],["for","terms"],[1,"col-12","mt-4"],["type","submit",1,"w-100","rounded-pill","p-2","bg-primary","text-white","border-0",3,"disabled"],["class","spinner-border spinner-border-sm me-2",4,"ngIf"],[1,"col-12","text-center","mt-2"],[1,"mb-0"],["routerLink","/login",1,"link-underline"],[1,"text-danger"],["for","coupon",1,"fw-medium"],["formControlName","coupon_code","id","coupon","pInputText","",1,"w-100",3,"placeholder"],[1,"spinner-border","spinner-border-sm","me-2"]],template:function(d,t){if(d&1&&(a(0,"div",0)(1,"div",1)(2,"div",2),u(3,"img",3),n(),a(4,"h2",4),l(5),r(6,"translate"),n(),a(7,"form",5),P("ngSubmit",function(){return t.onSubmit()}),a(8,"div",6)(9,"div",7)(10,"div",8)(11,"label",9),l(12),r(13,"translate"),n(),u(14,"input",10),r(15,"translate"),h(16,ae,3,3,"small",11),n()(),a(17,"div",12)(18,"div",8)(19,"label",13),l(20),r(21,"translate"),n(),u(22,"p-select",14),r(23,"translate"),h(24,le,3,3,"small",11),n()(),a(25,"div",15)(26,"div",8)(27,"label",16),l(28),r(29,"translate"),n(),u(30,"input",17),r(31,"translate"),h(32,pe,3,3,"small",11),n()(),a(33,"div",18)(34,"div",19),u(35,"p-checkbox",20),a(36,"label",21),l(37),r(38,"translate"),n()()(),E(39,se,7,7,"div",7),a(40,"div",22)(41,"div",8)(42,"label",23),l(43),r(44,"translate"),n(),u(45,"p-password",24),r(46,"translate"),h(47,de,3,3,"small",11)(48,me,3,3,"small",11),n()(),a(49,"div",22)(50,"div",8)(51,"label",25),l(52),r(53,"translate"),n(),u(54,"p-password",26),r(55,"translate"),h(56,ue,3,3,"small",11)(57,ce,3,3,"small",11),n()(),a(58,"div",27)(59,"div",19),u(60,"p-checkbox",28),a(61,"label",29),l(62),r(63,"translate"),n()(),h(64,ge,3,3,"small",11),n(),a(65,"div",30)(66,"button",31),h(67,fe,1,0,"span",32),l(68),r(69,"translate"),r(70,"translate"),n()(),a(71,"div",33)(72,"p",34),l(73," Already have an account? "),a(74,"a",35),l(75),r(76,"translate"),n()()()()()()()),d&2){let g,m,_,k,w,x,S,C,I;e(5),c(o(6,39,"signup.title")),e(2),p("formGroup",t.signupForm),e(5),c(o(13,41,"signup.labels.name")),e(2),p("placeholder",b(o(15,43,"signup.placeholders.name"))),e(2),p("ngIf",((g=t.signupForm.get("name"))==null?null:g.touched)&&((g=t.signupForm.get("name"))==null||g.errors==null?null:g.errors.required)),e(4),c(o(21,45,"signup.labels.code")),e(2),p("placeholder",b(o(23,47,"signup.placeholders.code")))("options",t.codes),e(2),p("ngIf",((m=t.signupForm.get("country_code"))==null?null:m.touched)&&((m=t.signupForm.get("country_code"))==null||m.errors==null?null:m.errors.required)),e(4),c(o(29,49,"signup.labels.phoneNumber")),e(2),p("placeholder",b(o(31,51,"signup.placeholders.phoneNumber"))),e(2),p("ngIf",((_=t.signupForm.get("phone_number"))==null?null:_.touched)&&((_=t.signupForm.get("phone_number"))==null||_.errors==null?null:_.errors.required)),e(3),p("binary",!0),e(2),c(o(38,53,"signup.labels.havePromoCode")),e(2),M((k=t.signupForm.get("more"))!=null&&k.value?39:-1),e(4),c(o(44,55,"signup.labels.password")),e(2),p("placeholder",b(o(46,57,"signup.placeholders.password")))("feedback",!1)("toggleMask",!0),e(2),p("ngIf",((w=t.signupForm.get("password"))==null?null:w.touched)&&((w=t.signupForm.get("password"))==null||w.errors==null?null:w.errors.required)),e(),p("ngIf",((x=t.signupForm.get("password"))==null?null:x.touched)&&((x=t.signupForm.get("password"))==null||x.errors==null?null:x.errors.minlength)),e(4),c(o(53,59,"signup.labels.confirmPassword")),e(2),p("placeholder",b(o(55,61,"signup.placeholders.confirmPassword")))("feedback",!1)("toggleMask",!0),e(2),p("ngIf",((S=t.signupForm.get("confirmPassword"))==null?null:S.touched)&&((S=t.signupForm.get("confirmPassword"))==null||S.errors==null?null:S.errors.required)),e(),p("ngIf",((C=t.signupForm.get("confirmPassword"))==null?null:C.touched)&&((C=t.signupForm.get("confirmPassword"))==null||C.errors==null?null:C.errors.mustMatch)),e(3),p("binary",!0),e(2),c(o(63,63,"signup.labels.terms")),e(2),p("ngIf",((I=t.signupForm.get("terms"))==null?null:I.touched)&&((I=t.signupForm.get("terms"))==null||I.errors==null?null:I.errors.required)),e(2),p("disabled",t.signupForm.invalid||t.isSubmitting),e(),p("ngIf",t.isSubmitting),e(),f(" ",t.isSubmitting?o(69,65,"signup.buttons.creatingAccount"):o(70,67,"signup.buttons.signUp")," "),e(7),c(o(76,69,"signup.links.signIn"))}},dependencies:[N,T,K,j,V,G,A,O,U,Y,ee,H,ie,D,J,Z,te,R],styles:[".bg-primary[_ngcontent-%COMP%]{background:linear-gradient(45deg,var(--primary-color-500),var(--primary-color-400));border:1px solid var(--primary-color-500);color:#fff}*[_ngcontent-%COMP%]{accent-color:var(--primary-color-500)!important}  .p-checkbox-input:checked+.p-checkbox-box{background:var(--primary-color-500)}  .p-inputtext,   .p-select,   .p-dropdown .p-inputtext,   .p-password input{box-shadow:5px 5px 10px -5px var(--primary-color-200) inset;-webkit-box-shadow:5px 5px 10px -5px var(--primary-color-200) inset;-moz-box-shadow:5px 5px 10px -5px var(--primary-color-200) inset;background-color:var(--primary-color-100);border:1px solid var(--primary-color-200);border-radius:.375rem}"]})};function Le(){return i=>{if(!i.value)return null;let s=new Date(i.value);return new Date().getFullYear()-s.getFullYear()<13?{underage:!0}:null}}export{ne as SignupComponent,Le as ageValidator};
