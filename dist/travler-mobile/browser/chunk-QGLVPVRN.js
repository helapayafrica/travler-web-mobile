import{k as T}from"./chunk-GPQBVM7U.js";import{c as z}from"./chunk-35RUP4P6.js";import{Dc as F,Ic as s,Jc as p,Kc as P,Ob as u,Pb as a,Qb as o,Rb as C,Yb as y,Yc as k,_a as i,bc as x,dc as v,eb as b,hc as _,ic as O,jc as M,ka as d,la as g,lb as f,qb as w,rc as r,sc as m,tc as c,wb as S}from"./chunk-45NCVV7C.js";import"./chunk-TWZW5B45.js";var W=["wheelCanvas"],I=l=>({text:l});function E(l,t){if(l&1&&(a(0,"div",10)(1,"h3"),r(2),s(3,"translate"),o()()),l&2){let e=v();i(2),m(P(3,1,"wheelOfFortune.results.winner",F(4,I,e.lastResult.text)))}}var R=class l{constructor(t,e){this.cdr=t;this.zone=e}canvasRef;wheel;isSpinning=!1;lastResult=null;targetSegment=null;isControlledSpin=!1;shuffle(t){return t.map(e=>({item:e,sort:Math.random()})).sort((e,n)=>e.sort-n.sort).map(({item:e})=>e)}weightedSegments=[{fillStyle:"#ff6b6b",text:"Try Again",textFillStyle:"white",size:90},{fillStyle:"#4ecdc4",text:"10% Off",textFillStyle:"white",size:50},{fillStyle:"#ffaaa5",text:"Book again to spin",textFillStyle:"white",size:40},{fillStyle:"#ff8b94",text:"Try Again",textFillStyle:"white",size:90},{fillStyle:"#a8e6cf",text:"100sh off next travel",textFillStyle:"black",size:35},{fillStyle:"#ffe66d",text:"50% Off",textFillStyle:"black",size:30},{fillStyle:"#95e1d3",text:"100% Off Next travel",textFillStyle:"black",size:30}];wheelSegments=this.weightedSegments;ngOnInit(){this.initializeWheel()}initializeWheel(){this.wheel=new Winwheel({canvasId:"canvas",numSegments:this.wheelSegments.length,segments:this.wheelSegments.map(t=>({fillStyle:t.fillStyle,text:t.text,textFillStyle:t.textFillStyle,size:t.size})),textFontSize:12,textOrientation:"horizontal",textAlignment:"center",textMargin:null,textFontFamily:"Arial",textStrokeStyle:null,textLineWidth:1,outerRadius:140,innerRadius:0,strokeStyle:"#fff",lineWidth:2,animation:{type:"spinToStop",duration:4,spins:15,callbackFinished:this.onSpinFinished.bind(this)}}),console.log("callbackFinished:",this.wheel.animation.callbackFinished),this.wheel.draw()}startSpin(){this.isSpinning||(this.cdr.detectChanges(),this.wheel.rotationAngle=0,this.isSpinning=!0,this.lastResult=null,this.isControlledSpin=!1,this.targetSegment=null,this.wheel.startAnimation(),setTimeout(()=>{this.isSpinning&&(this.isSpinning=!1,this.cdr.detectChanges(),console.log("Fallback: Animation timeout reached"))},4500))}onSpinFinished(t){this.isSpinning=!1,this.cdr.detectChanges(),this.lastResult=t,console.log("Spin result:",t),console.log(this.isSpinning),this.cdr.detectChanges()}resetWheel(){this.wheel.stopAnimation(!1),this.wheel.rotationAngle=0,this.wheel.draw(),this.isSpinning=!1,this.cdr.detectChanges(),this.lastResult=null}spinToSegment(t){this.isSpinning||(this.isSpinning=!0,this.cdr.detectChanges(),this.lastResult=null,this.wheel.animation.stopAngle=this.wheel.getRandomForSegment(t),this.wheel.startAnimation())}spinToSpecificSegment(t){if(this.isSpinning)return;this.targetSegment=t,this.isControlledSpin=!0,this.isSpinning=!0,this.lastResult=null;let e=this.wheel.getRandomForSegment(t);this.wheel.animation.stopAngle=e,this.wheel.startAnimation(),setTimeout(()=>{this.isSpinning&&(this.isSpinning=!1,this.cdr.detectChanges(),console.log("Fallback: Animation timeout reached"))},4500)}getSegmentProbabilities(){let t=this.wheelSegments.reduce((e,n)=>e+n.size,0);return this.wheelSegments.map(e=>({text:e.text,probability:Math.round(e.size/t*100)}))}static \u0275fac=function(e){return new(e||l)(f(k),f(b))};static \u0275cmp=w({type:l,selectors:[["app-spin-the-wheel"]],viewQuery:function(e,n){if(e&1&&_(W,7),e&2){let h;O(h=M())&&(n.canvasRef=h.first)}},decls:19,vars:16,consts:[["wheelCanvas",""],[1,"component-container"],[1,"wheel-container"],[1,"text-center","mb-4","fw-bold"],["width","300","height","300","id","canvas"],[1,"wheel-pointer"],[1,"controls"],[1,"spin-button",3,"click","disabled"],[1,"reset-button",3,"click"],["class","result",4,"ngIf"],[1,"result"]],template:function(e,n){if(e&1){let h=y();a(0,"div",1)(1,"div",2)(2,"h2",3),r(3),s(4,"translate"),o(),a(5,"canvas",4,0),r(7),s(8,"translate"),o(),C(9,"div",5),a(10,"div",6)(11,"button",7),x("click",function(){return d(h),g(n.startSpin())}),r(12),s(13,"translate"),s(14,"translate"),o(),a(15,"button",8),x("click",function(){return d(h),g(n.resetWheel())}),r(16),s(17,"translate"),o()()(),S(18,E,4,6,"div",9),o()}e&2&&(i(3),m(p(4,6,"wheelOfFortune.title")),i(4),c(" ",p(8,8,"wheelOfFortune.canvasFallback")," "),i(4),u("disabled",n.isSpinning),i(),c(" ",n.isSpinning?p(13,10,"wheelOfFortune.buttons.spinning"):p(14,12,"wheelOfFortune.buttons.spin")," "),i(4),c(" ",p(17,14,"wheelOfFortune.buttons.reset")," "),i(2),u("ngIf",n.lastResult))},dependencies:[T,z],styles:['.component-container[_ngcontent-%COMP%]{margin-top:6rem;min-height:70vh}.wheel-container[_ngcontent-%COMP%]{text-align:center;padding:20px;font-family:Arial,sans-serif}.controls[_ngcontent-%COMP%]{margin:20px 0}.spin-button[_ngcontent-%COMP%]{background:linear-gradient(45deg,#ff6b6b,#ee5a24);color:#fff;border:none;padding:15px 30px;font-size:18px;font-weight:700;border-radius:50px;cursor:pointer;margin:10px;transition:all .3s ease;box-shadow:0 4px 15px #ff6b6b4d}.spin-button[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 6px 20px #ff6b6b66}.spin-button[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.reset-button[_ngcontent-%COMP%]{background:#74b9ff;color:#fff;border:none;padding:10px 20px;border-radius:25px;cursor:pointer;margin:10px}.reset-button[_ngcontent-%COMP%]:hover{background:#0984e3}.result[_ngcontent-%COMP%]{margin-top:20px;padding:20px;background:linear-gradient(45deg,#00b894,#00cec9);color:#fff;border-radius:10px;display:inline-block}h2[_ngcontent-%COMP%]{color:#2d3436;margin-bottom:20px}#canvas[_ngcontent-%COMP%]{max-width:90vw;max-height:90vw;height:auto;width:auto}.wheel-container[_ngcontent-%COMP%]{position:relative}.wheel-pointer[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-200%);width:4px;height:50px;background:linear-gradient(to bottom,#ff4757,#2c2c2c);border-radius:2px;z-index:10;filter:drop-shadow(0 2px 4px rgba(0,0,0,.3))}.wheel-pointer[_ngcontent-%COMP%]:before{content:"";position:absolute;bottom:-10px;left:-8px;width:20px;height:20px;background:#2c2c2c;border-radius:50%;border:2px solid white}@media (max-width: 480px){.wheel-container[_ngcontent-%COMP%]{padding:5px}.wheel-pointer[_ngcontent-%COMP%]{border-left:12px solid transparent;border-right:12px solid transparent;border-top:24px solid #ff4757;transform:translate(-50%,-180%)}.wheel-pointer[_ngcontent-%COMP%]:after{width:12px;height:12px;left:-6px;top:-30px}.spin-button[_ngcontent-%COMP%]{padding:10px 20px;font-size:14px}.reset-button[_ngcontent-%COMP%]{padding:6px 12px;font-size:12px}}.control-section[_ngcontent-%COMP%]{margin-top:20px;padding:15px;border:2px solid #ddd;border-radius:10px;background:#f8f9fa}.control-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 10px;color:#2d3436}.segment-controls[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:8px;justify-content:center}.segment-button[_ngcontent-%COMP%]{color:#fff;border:none;padding:8px 12px;border-radius:15px;cursor:pointer;font-size:12px;font-weight:700;text-shadow:1px 1px 1px rgba(0,0,0,.5);transition:transform .2s}.segment-button[_ngcontent-%COMP%]:hover:not(:disabled){transform:scale(1.05)}.segment-button[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}']})};export{R as SpinTheWheel};
