import{a as z}from"./chunk-3HZLL5PW.js";import{a as K}from"./chunk-6VJONNZN.js";import{a as $}from"./chunk-CBO7K72Y.js";import{a as W,b as H}from"./chunk-MK3S6FXP.js";import"./chunk-IOPHG2KH.js";import"./chunk-H4ZN6NX2.js";import"./chunk-ZGVWO2O4.js";import{g as k,h as B,l as U}from"./chunk-NMHFSZUN.js";import"./chunk-4QCEHMDE.js";import{a as D}from"./chunk-LF2IBCJR.js";import"./chunk-KLFOQ2RT.js";import{B as V,c as M,d as h,f as E,g as N,l as P,p as O,q as T,r as j,s as R,t as q,y as A,z as G}from"./chunk-RAZRMRQX.js";import"./chunk-7UZYWCAJ.js";import"./chunk-6LBJZWJB.js";import{j as I,k as F,v as C}from"./chunk-GPQBVM7U.js";import{c as L}from"./chunk-35RUP4P6.js";import{Ic as n,Jc as a,Ob as p,Pb as r,Qb as t,Rb as f,_a as i,bc as y,ea as w,lb as c,qb as S,rc as l,sc as u,tc as b,wb as x,zc as _}from"./chunk-45NCVV7C.js";import"./chunk-TWZW5B45.js";function Q(o,m){if(o&1&&(r(0,"option",31),l(1),t()),o&2){let s=m.$implicit;p("value",s.code),i(),u(s.code)}}function X(o,m){o&1&&(r(0,"small",32),l(1),n(2,"translate"),t()),o&2&&(i(),b(" ",a(2,1,"login.validation.phoneRequired")," "))}function Y(o,m){o&1&&(r(0,"small",32),l(1),n(2,"translate"),t()),o&2&&(i(),b(" ",a(2,1,"login.validation.passwordRequired")," "))}function Z(o,m){o&1&&(r(0,"small",32),l(1),n(2,"translate"),t()),o&2&&(i(),b(" ",a(2,1,"login.validation.passwordMinLength")," "))}function ee(o,m){o&1&&f(0,"span",33)}var J=class o{constructor(m,s,e,d,g,v){this.fb=m;this.router=s;this.authService=e;this.service=d;this.bookingService=g;this.loginService=v}loginForm;isSubmitting=!1;showPassword=!1;toastr=w(z);country_codes=[{code:"254",country:"Kenya"},{code:"255",country:"Tanzania"},{code:"256",country:"Uganda"},{code:"250",country:"Rwanda"}];codes=[{value:"254",label:"+254"},{value:"255",label:"+255"},{value:"256",label:"+256"},{value:"250",label:"+250"}];ngOnInit(){this.initForm()}initForm(){this.loginForm=this.fb.group({country_code:["254",h.required],phone_number:["",[h.required,h.pattern(/^\d{7,15}$/)]],password:["",[h.required,h.minLength(6)]],rememberMe:[!1]})}togglePasswordVisibility(){this.showPassword=!this.showPassword}onSubmit(){if(this.loginForm.invalid){this.loginForm.markAllAsTouched();return}this.isSubmitting=!0;let s={username:this.loginForm.value.phone_number.replace(/^0+/,"").trim(),password:this.loginForm.value.password.trim(),gcm_token:"",country_code:this.loginForm.value.country_code,sourcetype:"web"};this.service.login(s).subscribe({next:e=>{this.isSubmitting=!1,e.isSuccess?(this.toastr.success("Logged in successfully."),this.authService.login(e.data),this.router.navigateByUrl("/")):this.toastr.error(e.errors.password?.[0]||e.errors.email?.[0]||"Invalid credentials","Login Failed")},error:e=>{this.isSubmitting=!1,console.error("Login error:",e),this.toastr.error(e?.error?.message||"Something went wrong. Please try again.","Server Error")}})}signUp(){this.router.navigate(["/sign-up"])}static \u0275fac=function(s){return new(s||o)(c(G),c(k),c(W),c(D),c(U),c(H))};static \u0275cmp=S({type:o,selectors:[["app-view-auth-login"]],decls:51,vars:36,consts:[[1,"container",2,"height","70vh","margin-top","7rem"],[1,"card","shadow"],[1,"card-header","m-0"],[1,"text-center"],["src","assets/WEBP/logo.webp","width","180px","height","auto","alt","logo"],[1,"text-center","mb-2","fw-bold"],[1,"card-body"],[3,"ngSubmit","formGroup"],[1,"row"],[1,"mt-2","col-12"],[1,"d-flex","flex-column","gap-1"],["for","phone"],[1,"input-group"],["formControlName","country_code",1,"form-select",2,"max-width","120px"],[3,"value",4,"ngFor","ngForOf"],["formControlName","phone_number","id","phone","type","tel","inputmode","tel","pattern","^\\+?[0-9\\s\\-]{7,15}$",1,"form-control","p-2",3,"placeholder"],["class","text-danger",4,"ngIf"],["for","password"],["formControlName","password","inputId","password","inputStyleClass","w-100 form-control",3,"feedback","toggleMask"],[1,"mt-3","row"],[1,"col","d-flex","align-items-center","justify-content-start"],["inputId","rememberMe","formControlName","rememberMe","binary","true"],["for","rememberMe",1,"ms-2"],[1,"col","text-end"],["routerLink","/forgot-password",1,"text-decoration-none"],[1,"col-12","mt-3"],["type","submit",1,"w-100","rounded-pill","p-2","bg-primary","text-white",3,"disabled"],["class","spinner-border spinner-border-sm me-2",4,"ngIf"],[1,"text-center","mt-3"],[1,"mb-0"],["routerLink","/sign-up",1,"link-underline",2,"cursor","pointer"],[3,"value"],[1,"text-danger"],[1,"spinner-border","spinner-border-sm","me-2"]],template:function(s,e){if(s&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),f(4,"img",4),t(),r(5,"h3",5),l(6),n(7,"translate"),t()(),r(8,"div",6)(9,"form",7),y("ngSubmit",function(){return e.onSubmit()}),r(10,"div",8)(11,"div",9)(12,"div",10)(13,"label",11),l(14),n(15,"translate"),t(),r(16,"div",12)(17,"select",13),x(18,Q,2,2,"option",14),t(),f(19,"input",15),n(20,"translate"),t(),x(21,X,3,3,"small",16),t()(),r(22,"div",9)(23,"div",10)(24,"label",17),l(25),n(26,"translate"),t(),f(27,"p-password",18),x(28,Y,3,3,"small",16)(29,Z,3,3,"small",16),t()(),r(30,"div",19)(31,"div",20),f(32,"p-checkbox",21),r(33,"label",22),l(34),n(35,"translate"),t()(),r(36,"div",23)(37,"a",24),l(38),n(39,"translate"),t()()()(),r(40,"div",25)(41,"button",26),x(42,ee,1,0,"span",27),l(43),n(44,"translate"),n(45,"translate"),t()(),r(46,"div",28)(47,"p",29)(48,"a",30),l(49),n(50,"translate"),t()()()()()()()),s&2){let d,g,v;i(6),u(a(7,18,"login.title")),i(3),p("formGroup",e.loginForm),i(5),u(a(15,20,"login.labels.phoneNumber")),i(4),p("ngForOf",e.country_codes),i(),p("placeholder",_(a(20,22,"login.placeholders.phoneNumber"))),i(2),p("ngIf",((d=e.loginForm.get("phone_number"))==null?null:d.touched)&&((d=e.loginForm.get("phone_number"))==null||d.errors==null?null:d.errors.required)),i(4),u(a(26,24,"login.labels.password")),i(2),p("feedback",!1)("toggleMask",!0),i(),p("ngIf",((g=e.loginForm.get("password"))==null?null:g.touched)&&((g=e.loginForm.get("password"))==null||g.errors==null?null:g.errors.required)),i(),p("ngIf",((v=e.loginForm.get("password"))==null?null:v.touched)&&((v=e.loginForm.get("password"))==null||v.errors==null?null:v.errors.minlength)),i(5),u(a(35,26,"login.labels.rememberMe")),i(4),u(a(39,28,"login.labels.forgotPassword")),i(3),p("disabled",e.loginForm.invalid||e.isSubmitting),i(),p("ngIf",e.isSubmitting),i(),b(" ",e.isSubmitting?a(44,30,"login.buttons.loggingIn"):a(45,32,"login.buttons.signIn")," "),i(6),b(" ",a(50,34,"login.labels.signUpLink")," ")}},dependencies:[C,I,F,B,V,P,R,q,M,j,E,N,A,O,T,$,K,L],styles:[".bg-primary[_ngcontent-%COMP%]{background:linear-gradient(45deg,var(--primary-color-500),var(--primary-color-400));border:1px solid var(--primary-color-500);color:#fff}.form-control[_ngcontent-%COMP%], .form-select[_ngcontent-%COMP%], input-group-text[_ngcontent-%COMP%]{box-shadow:5px 5px 10px -5px var(--primary-color-200) inset;-webkit-box-shadow:5px 5px 10px -5px var(--primary-color-200) inset;-moz-box-shadow:5px 5px 10px -5px var(--primary-color-200) inset;background-color:var(--primary-color-100);border:1px solid var(--primary-color-200);border-radius:.375rem}.form-label[_ngcontent-%COMP%]{font-weight:500;margin-bottom:.5rem}  .p-dropdown .p-inputtext,   .p-select,   .p-password input{box-shadow:5px 5px 10px -5px var(--primary-color-200) inset;-webkit-box-shadow:5px 5px 10px -5px var(--primary-color-200) inset;-moz-box-shadow:5px 5px 10px -5px var(--primary-color-200) inset;background-color:var(--primary-color-100);border:1px solid var(--primary-color-200);border-radius:.375rem}"]})};export{J as LoginComponent};
